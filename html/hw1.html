
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>hw1</title><meta name="generator" content="MATLAB 8.3"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-12-16"><meta name="DC.source" content="hw1.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Problem iii) Calculating the parameters for each of the distributions</a></li><li><a href="#3">Problem iv: Superimpose graphs of histograms and marginal denseties</a></li><li><a href="#4">Problem v)</a></li><li><a href="#5">Bigger plots of the distributions</a></li></ul></div><pre class="codeinput"><span class="comment">% HW, Statistical Signal Processing,</span>
<span class="comment">% Written by Henning Schei</span>

<span class="comment">%Collecting data from 3 different places</span>
choise = 0;
close <span class="string">all</span>;
<span class="keyword">if</span> (choise)
    res=zeros(1000,4);
    res(1:1000,1) = pingstats(<span class="string">'mercury.iet.ntnu.no'</span> , 1000, <span class="string">''</span>); <span class="comment">% Norwegian Univ. of Science and Technology #1 in res</span>
    res(1:1000,2) = pingstats(<span class="string">'atalante.stanford.edu'</span>, 1000,<span class="string">''</span>); <span class="comment">% Standford University                      #2 in res</span>
    res(1:1000,3) = pingstats(<span class="string">'mx.vvsu.ru'</span>,1000,<span class="string">''</span>);<span class="comment">% Vladivostok State University of Econimics and Service  #3 in res</span>
    res(1:1000,4) = pingstats(<span class="string">'197.255.176.1'</span>,1000,<span class="string">''</span>); <span class="comment">%Brazzaville, Congo</span>
<span class="keyword">else</span>

    <span class="comment">% Check if data file exists</span>
    <span class="keyword">if</span> exist(<span class="string">'pingmania.mat'</span>,<span class="string">'file'</span>) == 2
        <span class="comment">% unpack from .mat file pingmania.mat</span>
        tmp  = load(<span class="string">'pingmania.mat'</span>);
        res  = tmp.res(:,:); <span class="comment">% fix 4.colunm</span>
    <span class="keyword">else</span>
        fprintf(<span class="string">'You need to add til file pingmania.mat to the current directory\n'</span>);
        <span class="keyword">return</span>
    <span class="keyword">end</span>

<span class="keyword">end</span>


data = res(1:1000,1); <span class="comment">% Using the data from Norwegian Univ. of Science and Technology</span>
</pre><h2>Problem iii) Calculating the parameters for each of the distributions<a name="2"></a></h2><pre class="codeinput"><span class="comment">% Gaussian distribution</span>

mu_G = sum(data)/length(data);
tmp=0;
<span class="keyword">for</span> i = 1:length(data)
    tmp = tmp + power(data(i) - mu_G,2);
<span class="keyword">end</span>
ro_G = tmp/length(data);

<span class="comment">% Rayleigh</span>
ro_R = power(2*length(data),-1) * sum (data.^2);


<span class="comment">% Erlang distribution</span>
m = [1,2,3];
lambda_E = (m*length(data))/sum(data);

<span class="comment">% Shifted exponential distribution</span>
alpha_exp = min(data);
tmp=0;
<span class="keyword">for</span> i =1:length(data)
    tmp = tmp + data(i) - alpha_exp;
<span class="keyword">end</span>

lambda_exp = length(data)/tmp;


<span class="comment">% Shifted Rayleigh</span>
</pre><h2>Problem iv: Superimpose graphs of histograms and marginal denseties<a name="3"></a></h2><pre class="codeinput"><span class="comment">% pdf's:</span>

f_G = (1./sqrt(2.*pi.*ro_G)) .* exp(-power( (1:1000)-mu_G,2)./(2.*ro_G));
f_R = ((1:1000)./ro_R).*exp (-(power((1:1000),2))./(2.*ro_R ));
M = 1;
f_E1 = (power(lambda_E(1),M+1)./(factorial(M))).*power((1:1000),M).*exp(-lambda_E(1).*(1:1000));
M = 2;
f_E2 = (power(lambda_E(2),M+1)./(factorial(M))).*power((1:1000),M).*exp(-lambda_E(2).*(1:1000));
M = 3;
f_E3 = (power(lambda_E(3),M+1)./(factorial(M))).*power((1:1000),M).*exp(-lambda_E(3).*(1:1000));
f_exp = zeros(1,1000);
<span class="keyword">for</span> i=1:1000
    <span class="keyword">if</span> i&lt; alpha_exp
        f_exp(i)=0;
    <span class="keyword">elseif</span> i&gt;=alpha_exp
        f_exp(i) = lambda_exp .* exp(-lambda_exp.*(i-alpha_exp));
    <span class="keyword">end</span>
<span class="keyword">end</span>
alpha_SR = min(data)+0.01;
f_SR = zeros(1,1000);
tmp1=0;
tmp2=0;

<span class="keyword">for</span> j=1:1000
    tmp1 = tmp1 + data(j)-alpha_SR;
    tmp2 = tmp2 + 1/(data(j)-alpha_SR);
<span class="keyword">end</span>

ro_SR=tmp1/tmp2;

<span class="keyword">for</span> i =1:1000
    <span class="keyword">if</span> i&lt;alpha_SR
        f_SR(i)=0;
    <span class="keyword">elseif</span> i&gt;=alpha_SR
        f_SR(i)= ((i-alpha_SR)./ro_SR)*exp(-((i-alpha_SR).^2)./(2*ro_SR));
    <span class="keyword">end</span>
<span class="keyword">end</span>


figure;
<span class="comment">% Plotting histograms and margnial densisies</span>

subplot(4,2,1)
hist(res(:,1), 500);
xlabel <span class="string">'msec'</span>
ylabel <span class="string">'#ping'</span>
title <span class="string">'mercury.iet.ntnu.no - Located in Trondheim, Norway'</span>;
subplot(4,2,2)
plot(f_G)
xlim([0 max(data)+100])
ylabel <span class="string">'Pr'</span>
title  <span class="string">'Gaussian distribution'</span>
subplot(4,2,3)
plot(f_E1);
xlim([0 max(data)+100])
xlabel <span class="string">'m'</span>
title <span class="string">'Erlang distribution m=1'</span>
subplot(4,2,4)
plot(f_E2)
xlim([0 max(data)+100])
title <span class="string">'Erlang distribution m=2'</span>
subplot(4,2,5)
plot(f_E3)
xlim([0 max(data)+100])
title <span class="string">'Erlang distribution m=3'</span>
subplot(4,2,6)
plot(f_exp)
xlim([0 max(data)+100])
title <span class="string">'Shifted exponential distribution'</span>
subplot(4,2,7)
plot(f_R)
xlim([0 max(data)+100])
title <span class="string">'Rayleigh distribution'</span>
subplot(4,2,8)
plot(f_SR)
xlim([0 max(data)+100])
title <span class="string">'Shifted Reyleigh distribution'</span>
</pre><img vspace="5" hspace="5" src="hw1_01.png" alt=""> <h2>Problem v)<a name="4"></a></h2><p>Finding the distribution that maximizes the likelihood: Putting in the measured data in the pdf's</p><pre class="codeinput">f_GI = (1./sqrt(2.*pi.*ro_G)) .* exp(-power( (data)-mu_G,2)./(2.*ro_G));
f_RI = ((data)./ro_R).*exp (-(power((data),2))./(2.*ro_R ));
f_E1I = (power(lambda_E(1),M+1)./(factorial(M))).*power((data),M).*exp(-lambda_E(1).*(data));
M = 2;
f_E2I = (power(lambda_E(2),M+1)./(factorial(M))).*power((data),M).*exp(-lambda_E(2).*(data));
M = 3;
f_E3I = (power(lambda_E(3),M+1)./(factorial(M))).*power((data),M).*exp(-lambda_E(3).*(data));


f_expI = lambda_exp .* exp(-lambda_exp.*(data-alpha_exp));
alpha_SR = min(data)+0.01; <span class="comment">% matlab does not like to divide by zero</span>

tmp1=0;
tmp2=0;
<span class="comment">% Finding ro_SR</span>
<span class="keyword">for</span> j=1:1000
    tmp1 = tmp1 + data(j)-alpha_SR;
    tmp2 = tmp2 + 1/(data(j)-alpha_SR);
<span class="keyword">end</span>
ro_SR=tmp1/tmp2;
data_SR = zeros(1,length(data));
<span class="keyword">for</span> i=1:length(data)
    data_SR(i) = data(i)-alpha_SR;
<span class="keyword">end</span>

f_SRI = ((data_SR)./ro_SR).*exp(-((data_SR).^2)./(2.*ro_SR));
f_SRI = f_SRI';
dists = [f_GI, f_RI, f_E1I, f_E2I, f_E3I, f_expI, f_SRI];
fists = {<span class="string">'Gaussian'</span>, <span class="string">'Rayleigh'</span>, <span class="string">'Erlang0'</span>,<span class="string">'Erlang1'</span>,<span class="string">'Erlang2'</span>, <span class="string">'Expoinential'</span>, <span class="string">'Shifted Rayleigh'</span>};
loglikelihoods(1:7) = sum(log(dists(:,1:7)));

[lhat,idx] = max(loglikelihoods);


<span class="comment">% Output shows that the shifted exponential distribution is the one that</span>
<span class="comment">% maximizes the likelihood function, and by obersvation this is also the pdf</span>
<span class="comment">% that visually fits best.</span>
</pre><h2>Bigger plots of the distributions<a name="5"></a></h2><pre class="codeinput">figure;
hist(res(:,1), 500);
xlabel <span class="string">'msec'</span>
ylabel <span class="string">'#ping'</span>
title <span class="string">'mercury.iet.ntnu.no - Located in Trondheim, Norway'</span>;
figure;
plot(f_G)
xlim([0 max(data)+100])
ylabel <span class="string">'Pr'</span>
title  <span class="string">'Gaussian distribution'</span>
figure;
plot(f_E1);
xlim([0 max(data)+100])
xlabel <span class="string">'m'</span>
title <span class="string">'Erlang distribution m=1'</span>
figure;
plot(f_E2)
xlim([0 max(data)+100])
title <span class="string">'Erlang distribution m=2'</span>
figure;
plot(f_E3)
xlim([0 max(data)+100])
title <span class="string">'Erlang distribution m=3'</span>
figure;
plot(f_exp)
xlim([0 max(data)+100])
title <span class="string">'Shifted exponential distribution'</span>
figure;
plot(f_R)
xlim([0 max(data)+100])
title <span class="string">'Rayleigh distribution'</span>
figure;
plot(f_SR)
xlim([0 max(data)+100])
title <span class="string">'Shifted Reyleigh distribution'</span>
</pre><img vspace="5" hspace="5" src="hw1_02.png" alt=""> <img vspace="5" hspace="5" src="hw1_03.png" alt=""> <img vspace="5" hspace="5" src="hw1_04.png" alt=""> <img vspace="5" hspace="5" src="hw1_05.png" alt=""> <img vspace="5" hspace="5" src="hw1_06.png" alt=""> <img vspace="5" hspace="5" src="hw1_07.png" alt=""> <img vspace="5" hspace="5" src="hw1_08.png" alt=""> <img vspace="5" hspace="5" src="hw1_09.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2014a</a><br></p></div><!--
##### SOURCE BEGIN #####

% HW, Statistical Signal Processing,
% Written by Henning Schei 

%Collecting data from 3 different places
choise = 0;
close all;
if (choise)
    res=zeros(1000,4);
    res(1:1000,1) = pingstats('mercury.iet.ntnu.no' , 1000, ''); % Norwegian Univ. of Science and Technology #1 in res
    res(1:1000,2) = pingstats('atalante.stanford.edu', 1000,''); % Standford University                      #2 in res
    res(1:1000,3) = pingstats('mx.vvsu.ru',1000,'');% Vladivostok State University of Econimics and Service  #3 in res
    res(1:1000,4) = pingstats('197.255.176.1',1000,''); %Brazzaville, Congo                                           
else
    
    % Check if data file exists
    if exist('pingmania.mat','file') == 2
        % unpack from .mat file pingmania.mat
        tmp  = load('pingmania.mat');
        res  = tmp.res(:,:); % fix 4.colunm
    else
        fprintf('You need to add til file pingmania.mat to the current directory\n');
        return
    end
    
end


data = res(1:1000,1); % Using the data from Norwegian Univ. of Science and Technology
%% Problem iii) Calculating the parameters for each of the distributions 

% Gaussian distribution

mu_G = sum(data)/length(data);
tmp=0;
for i = 1:length(data)
    tmp = tmp + power(data(i) - mu_G,2);
end
ro_G = tmp/length(data); 

% Rayleigh
ro_R = power(2*length(data),-1) * sum (data.^2);


% Erlang distribution
m = [1,2,3];
lambda_E = (m*length(data))/sum(data);

% Shifted exponential distribution
alpha_exp = min(data);
tmp=0;
for i =1:length(data)
    tmp = tmp + data(i) - alpha_exp; 
end

lambda_exp = length(data)/tmp;


% Shifted Rayleigh
 


%% Problem iv: Superimpose graphs of histograms and marginal denseties

% pdf's:

f_G = (1./sqrt(2.*pi.*ro_G)) .* exp(-power( (1:1000)-mu_G,2)./(2.*ro_G));
f_R = ((1:1000)./ro_R).*exp (-(power((1:1000),2))./(2.*ro_R ));
M = 1;
f_E1 = (power(lambda_E(1),M+1)./(factorial(M))).*power((1:1000),M).*exp(-lambda_E(1).*(1:1000));
M = 2;
f_E2 = (power(lambda_E(2),M+1)./(factorial(M))).*power((1:1000),M).*exp(-lambda_E(2).*(1:1000));
M = 3;
f_E3 = (power(lambda_E(3),M+1)./(factorial(M))).*power((1:1000),M).*exp(-lambda_E(3).*(1:1000));
f_exp = zeros(1,1000);
for i=1:1000
    if i< alpha_exp
        f_exp(i)=0;
    elseif i>=alpha_exp
        f_exp(i) = lambda_exp .* exp(-lambda_exp.*(i-alpha_exp));
    end
end
alpha_SR = min(data)+0.01;
f_SR = zeros(1,1000);
tmp1=0;
tmp2=0;

for j=1:1000
    tmp1 = tmp1 + data(j)-alpha_SR;
    tmp2 = tmp2 + 1/(data(j)-alpha_SR);
end

ro_SR=tmp1/tmp2;

for i =1:1000
    if i<alpha_SR
        f_SR(i)=0;
    elseif i>=alpha_SR
        f_SR(i)= ((i-alpha_SR)./ro_SR)*exp(-((i-alpha_SR).^2)./(2*ro_SR)); 
    end
end


figure; 
% Plotting histograms and margnial densisies

subplot(4,2,1)
hist(res(:,1), 500);
xlabel 'msec'
ylabel '#ping'
title 'mercury.iet.ntnu.no - Located in Trondheim, Norway';
subplot(4,2,2)
plot(f_G)
xlim([0 max(data)+100])
ylabel 'Pr'
title  'Gaussian distribution'
subplot(4,2,3)
plot(f_E1);
xlim([0 max(data)+100])
xlabel 'm'
title 'Erlang distribution m=1'
subplot(4,2,4)
plot(f_E2)
xlim([0 max(data)+100])
title 'Erlang distribution m=2'
subplot(4,2,5)
plot(f_E3)
xlim([0 max(data)+100])
title 'Erlang distribution m=3'
subplot(4,2,6)
plot(f_exp)
xlim([0 max(data)+100])
title 'Shifted exponential distribution'
subplot(4,2,7)
plot(f_R)
xlim([0 max(data)+100])
title 'Rayleigh distribution'
subplot(4,2,8)
plot(f_SR)
xlim([0 max(data)+100])
title 'Shifted Reyleigh distribution'





%% Problem v) 
%
% Finding the distribution that maximizes the likelihood: 
% Putting in the measured data in the pdf's



f_GI = (1./sqrt(2.*pi.*ro_G)) .* exp(-power( (data)-mu_G,2)./(2.*ro_G));
f_RI = ((data)./ro_R).*exp (-(power((data),2))./(2.*ro_R ));
f_E1I = (power(lambda_E(1),M+1)./(factorial(M))).*power((data),M).*exp(-lambda_E(1).*(data));
M = 2;
f_E2I = (power(lambda_E(2),M+1)./(factorial(M))).*power((data),M).*exp(-lambda_E(2).*(data));
M = 3;
f_E3I = (power(lambda_E(3),M+1)./(factorial(M))).*power((data),M).*exp(-lambda_E(3).*(data));


f_expI = lambda_exp .* exp(-lambda_exp.*(data-alpha_exp));    
alpha_SR = min(data)+0.01; % matlab does not like to divide by zero

tmp1=0;
tmp2=0;
% Finding ro_SR
for j=1:1000
    tmp1 = tmp1 + data(j)-alpha_SR;
    tmp2 = tmp2 + 1/(data(j)-alpha_SR);
end
ro_SR=tmp1/tmp2;
data_SR = zeros(1,length(data));
for i=1:length(data)
    data_SR(i) = data(i)-alpha_SR;
end

f_SRI = ((data_SR)./ro_SR).*exp(-((data_SR).^2)./(2.*ro_SR));      
f_SRI = f_SRI';
dists = [f_GI, f_RI, f_E1I, f_E2I, f_E3I, f_expI, f_SRI];
fists = {'Gaussian', 'Rayleigh', 'Erlang0','Erlang1','Erlang2', 'Expoinential', 'Shifted Rayleigh'};
loglikelihoods(1:7) = sum(log(dists(:,1:7)));

[lhat,idx] = max(loglikelihoods);


% Output shows that the shifted exponential distribution is the one that
% maximizes the likelihood function, and by obersvation this is also the pdf
% that visually fits best. 


%% Bigger plots of the distributions

figure;
hist(res(:,1), 500);
xlabel 'msec'
ylabel '#ping'
title 'mercury.iet.ntnu.no - Located in Trondheim, Norway';
figure;
plot(f_G)
xlim([0 max(data)+100])
ylabel 'Pr'
title  'Gaussian distribution'
figure;
plot(f_E1);
xlim([0 max(data)+100])
xlabel 'm'
title 'Erlang distribution m=1'
figure;
plot(f_E2)
xlim([0 max(data)+100])
title 'Erlang distribution m=2'
figure;
plot(f_E3)
xlim([0 max(data)+100])
title 'Erlang distribution m=3'
figure;
plot(f_exp)
xlim([0 max(data)+100])
title 'Shifted exponential distribution'
figure;
plot(f_R)
xlim([0 max(data)+100])
title 'Rayleigh distribution'
figure;
plot(f_SR)
xlim([0 max(data)+100])
title 'Shifted Reyleigh distribution'






##### SOURCE END #####
--></body></html>